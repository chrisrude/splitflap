import{s as wt,n as It,b as mt,f as Dt,r as le,o as se}from"../c/s.bc760b9c.js";import{S as yt,i as bt,g,s as b,m as I,h as v,j as w,y as W,c as T,n as q,f as p,k,a as H,x as f,o as Q,r as Ht,u as Rt,z as J,v as Pt,d as K,t as et,w as Lt,l as Wt,p as $t,b as te,A as ee,B as Ct,C as qt,D as tt,E as ae}from"../c/i.aa439040.js";function St(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}const ne=[" ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9",".",",","'"],lt=24,R=12,Kt=ne[0],oe=()=>({state:"unknown",flap_index:0,moving:!1,home_state:!1,count_unexpected_home:0,count_missed_home:0}),Yt=e=>e.state==="normal"||e.state==="unknown",Gt=e=>e.count_missed_home>0||e.count_unexpected_home>0,ie=()=>{const e=Array(lt);for(let t=0;t<lt;t++)e[t]=oe();return e};function re(e){let t,s,i,o,n="State",_,a,r=e[0].state+"",l,c,m,E,O="Flap Index",y,N,A=e[0].flap_index+"",V,Y,D,P,nt="Moving",d,U,C=e[0].moving?"Yes":"No",F,u,h,S,ut="Home State",st,B,L=e[0].home_state?"Home":"Not Home",G,Tt,X,Z,At="Unexpected<br/>Home",Et,at,ot=e[0].count_unexpected_home+"",ft,Vt,x,$,zt="Missed<br/>Home",kt,it,rt=e[0].count_missed_home+"",ct;return{c(){t=g("div"),s=g("table"),i=g("tr"),o=g("th"),o.textContent=n,_=b(),a=g("td"),l=I(r),c=b(),m=g("tr"),E=g("th"),E.textContent=O,y=b(),N=g("td"),V=I(A),Y=b(),D=g("tr"),P=g("th"),P.textContent=nt,d=b(),U=g("td"),F=I(C),u=b(),h=g("tr"),S=g("th"),S.textContent=ut,st=b(),B=g("td"),G=I(L),Tt=b(),X=g("tr"),Z=g("th"),Z.innerHTML=At,Et=b(),at=g("td"),ft=I(ot),Vt=b(),x=g("tr"),$=g("th"),$.innerHTML=zt,kt=b(),it=g("td"),ct=I(rt),this.h()},l(z){t=v(z,"DIV",{class:!0});var j=w(t);s=v(j,"TABLE",{});var M=w(s);i=v(M,"TR",{});var dt=w(i);o=v(dt,"TH",{class:!0,"data-svelte-h":!0}),W(o)!=="svelte-8azjil"&&(o.textContent=n),_=T(dt),a=v(dt,"TD",{});var Mt=w(a);l=q(Mt,r),Mt.forEach(p),dt.forEach(p),c=T(M),m=v(M,"TR",{});var _t=w(m);E=v(_t,"TH",{class:!0,"data-svelte-h":!0}),W(E)!=="svelte-6pmfnd"&&(E.textContent=O),y=T(_t),N=v(_t,"TD",{});var Ut=w(N);V=q(Ut,A),Ut.forEach(p),_t.forEach(p),Y=T(M),D=v(M,"TR",{});var pt=w(D);P=v(pt,"TH",{class:!0,"data-svelte-h":!0}),W(P)!=="svelte-lwsec8"&&(P.textContent=nt),d=T(pt),U=v(pt,"TD",{});var jt=w(U);F=q(jt,C),jt.forEach(p),pt.forEach(p),u=T(M),h=v(M,"TR",{});var ht=w(h);S=v(ht,"TH",{class:!0,"data-svelte-h":!0}),W(S)!=="svelte-16b17l4"&&(S.textContent=ut),st=T(ht),B=v(ht,"TD",{});var Nt=w(B);G=q(Nt,L),Nt.forEach(p),ht.forEach(p),Tt=T(M),X=v(M,"TR",{});var gt=w(X);Z=v(gt,"TH",{class:!0,"data-svelte-h":!0}),W(Z)!=="svelte-18hz36f"&&(Z.innerHTML=At),Et=T(gt),at=v(gt,"TD",{});var Ot=w(at);ft=q(Ot,ot),Ot.forEach(p),gt.forEach(p),Vt=T(M),x=v(M,"TR",{});var vt=w(x);$=v(vt,"TH",{class:!0,"data-svelte-h":!0}),W($)!=="svelte-1f9907h"&&($.innerHTML=zt),kt=T(vt),it=v(vt,"TD",{});var Bt=w(it);ct=q(Bt,rt),Bt.forEach(p),vt.forEach(p),M.forEach(p),j.forEach(p),this.h()},h(){k(o,"class","svelte-29zy2o"),k(E,"class","svelte-29zy2o"),k(P,"class","svelte-29zy2o"),k(S,"class","svelte-29zy2o"),k(Z,"class","svelte-29zy2o"),k($,"class","svelte-29zy2o"),k(t,"class","flap_status svelte-29zy2o")},m(z,j){H(z,t,j),f(t,s),f(s,i),f(i,o),f(i,_),f(i,a),f(a,l),f(s,c),f(s,m),f(m,E),f(m,y),f(m,N),f(N,V),f(s,Y),f(s,D),f(D,P),f(D,d),f(D,U),f(U,F),f(s,u),f(s,h),f(h,S),f(h,st),f(h,B),f(B,G),f(s,Tt),f(s,X),f(X,Z),f(X,Et),f(X,at),f(at,ft),f(s,Vt),f(s,x),f(x,$),f(x,kt),f(x,it),f(it,ct)},p(z,[j]){j&1&&r!==(r=z[0].state+"")&&Q(l,r),j&1&&A!==(A=z[0].flap_index+"")&&Q(V,A),j&1&&C!==(C=z[0].moving?"Yes":"No")&&Q(F,C),j&1&&L!==(L=z[0].home_state?"Home":"Not Home")&&Q(G,L),j&1&&ot!==(ot=z[0].count_unexpected_home+"")&&Q(ft,ot),j&1&&rt!==(rt=z[0].count_missed_home+"")&&Q(ct,rt)},i:It,o:It,d(z){z&&p(t)}}}function ue(e,t,s){let{status:i}=t;return e.$$set=o=>{"status"in o&&s(0,i=o.status)},[i]}class fe extends yt{constructor(t){super(),bt(this,t,ue,re,wt,{status:0})}}function ce(e){let t;return{c(){t=I(e[0])},l(s){t=q(s,e[0])},m(s,i){H(s,t,i)},p(s,i){i&1&&Q(t,s[0])},d(s){s&&p(t)}}}function de(e){let t;return{c(){t=I(e[1])},l(s){t=q(s,e[1])},m(s,i){H(s,t,i)},p(s,i){i&2&&Q(t,s[1])},d(s){s&&p(t)}}}function _e(e){let t,s,i,o,n;function _(l,c){return l[1]!==void 0?de:ce}let a=_(e),r=a(e);return o=new fe({props:{status:e[3]}}),{c(){t=g("div"),r.c(),s=b(),i=g("div"),Ht(o.$$.fragment),this.h()},l(l){t=v(l,"DIV",{class:!0});var c=w(t);r.l(c),s=T(c),i=v(c,"DIV",{class:!0});var m=w(i);Rt(o.$$.fragment,m),m.forEach(p),c.forEach(p),this.h()},h(){k(i,"class","flap_status svelte-govrmu"),J(i,"error",!Yt(e[3])),J(i,"warning",Gt(e[3])),k(t,"class","flap svelte-govrmu"),J(t,"selected",e[2]),J(t,"pendingValue",e[1]!==void 0)},m(l,c){H(l,t,c),r.m(t,null),f(t,s),f(t,i),Pt(o,i,null),n=!0},p(l,[c]){a===(a=_(l))&&r?r.p(l,c):(r.d(1),r=a(l),r&&(r.c(),r.m(t,s)));const m={};c&8&&(m.status=l[3]),o.$set(m),(!n||c&8)&&J(i,"error",!Yt(l[3])),(!n||c&8)&&J(i,"warning",Gt(l[3])),(!n||c&4)&&J(t,"selected",l[2]),(!n||c&2)&&J(t,"pendingValue",l[1]!==void 0)},i(l){n||(K(o.$$.fragment,l),n=!0)},o(l){et(o.$$.fragment,l),n=!1},d(l){l&&p(t),r.d(),Lt(o)}}}function pe(e,t,s){let{value:i}=t,{pendingValue:o}=t,{selected:n=!1}=t,{status:_}=t;return e.$$set=a=>{"value"in a&&s(0,i=a.value),"pendingValue"in a&&s(1,o=a.pendingValue),"selected"in a&&s(2,n=a.selected),"status"in a&&s(3,_=a.status)},[i,o,n,_]}class he extends yt{constructor(t){super(),bt(this,t,pe,_e,wt,{value:0,pendingValue:1,selected:2,status:3})}}function Jt(e,t,s){const i=e.slice();return i[6]=t[s],i[8]=s,i}function Qt(e,t,s){const i=e.slice();return i[9]=t[s],i[11]=s,i}function Xt(e){var i;let t,s;return t=new he({props:{value:e[9].current,pendingValue:e[9].pending,status:e[1][e[8]*R+e[11]],selected:e[8]*R+e[11]===((i=e[0])==null?void 0:i.length)}}),{c(){Ht(t.$$.fragment)},l(o){Rt(t.$$.fragment,o)},m(o,n){Pt(t,o,n),s=!0},p(o,n){var a;const _={};n&4&&(_.value=o[9].current),n&4&&(_.pendingValue=o[9].pending),n&2&&(_.status=o[1][o[8]*R+o[11]]),n&1&&(_.selected=o[8]*R+o[11]===((a=o[0])==null?void 0:a.length)),t.$set(_)},i(o){s||(K(t.$$.fragment,o),s=!0)},o(o){et(t.$$.fragment,o),s=!1},d(o){Lt(t,o)}}}function Zt(e){let t,s,i,o=St(e[2].slice(e[8]*R,(e[8]+1)*R)),n=[];for(let a=0;a<o.length;a+=1)n[a]=Xt(Qt(e,o,a));const _=a=>et(n[a],1,1,()=>{n[a]=null});return{c(){t=g("div");for(let a=0;a<n.length;a+=1)n[a].c();s=b(),this.h()},l(a){t=v(a,"DIV",{class:!0});var r=w(t);for(let l=0;l<n.length;l+=1)n[l].l(r);s=T(r),r.forEach(p),this.h()},h(){k(t,"class","flapRow svelte-ydaj79")},m(a,r){H(a,t,r);for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(t,null);f(t,s),i=!0},p(a,r){if(r&7){o=St(a[2].slice(a[8]*R,(a[8]+1)*R));let l;for(l=0;l<o.length;l+=1){const c=Qt(a,o,l);n[l]?(n[l].p(c,r),K(n[l],1)):(n[l]=Xt(c),n[l].c(),K(n[l],1),n[l].m(t,s))}for($t(),l=o.length;l<n.length;l+=1)_(l);te()}},i(a){if(!i){for(let r=0;r<o.length;r+=1)K(n[r]);i=!0}},o(a){n=n.filter(Boolean);for(let r=0;r<n.length;r+=1)et(n[r]);i=!1},d(a){a&&p(t),ee(n,a)}}}function ge(e){let t,s,i,o=St({length:e[3]}),n=[];for(let a=0;a<o.length;a+=1)n[a]=Zt(Jt(e,o,a));const _=a=>et(n[a],1,1,()=>{n[a]=null});return{c(){t=g("div"),s=g("div");for(let a=0;a<n.length;a+=1)n[a].c();this.h()},l(a){t=v(a,"DIV",{class:!0});var r=w(t);s=v(r,"DIV",{style:!0});var l=w(s);for(let c=0;c<n.length;c+=1)n[c].l(l);l.forEach(p),r.forEach(p),this.h()},h(){Wt(s,"display","contents"),Wt(s,"--modules-per-row",R),k(t,"class","flapDisplay svelte-ydaj79")},m(a,r){H(a,t,r),f(t,s);for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(s,null);i=!0},p(a,[r]){if(r&7){o=St({length:a[3]});let l;for(l=0;l<o.length;l+=1){const c=Jt(a,o,l);n[l]?(n[l].p(c,r),K(n[l],1)):(n[l]=Zt(c),n[l].c(),K(n[l],1),n[l].m(s,null))}for($t(),l=o.length;l<n.length;l+=1)_(l);te()}},i(a){if(!i){for(let r=0;r<o.length;r+=1)K(n[r]);i=!0}},o(a){n=n.filter(Boolean);for(let r=0;r<n.length;r+=1)et(n[r]);i=!1},d(a){a&&p(t),ee(n,a)}}}function ve(e,t,s){const i=lt/R;let{flapString:o}=t,{flapStringPending:n}=t,{flapStatusValues:_}=t,a=Array(lt).fill({current:Kt});const r=()=>{s(2,a=a.map((l,c)=>{var m,E;return{current:(m=o[c])!==null&&m!==void 0?m:Kt,pending:(E=n==null?void 0:n[c])!==null&&E!==void 0?E:void 0}}))};return e.$$set=l=>{"flapString"in l&&s(4,o=l.flapString),"flapStringPending"in l&&s(0,n=l.flapStringPending),"flapStatusValues"in l&&s(1,_=l.flapStatusValues)},e.$$.update=()=>{e.$$.dirty&17&&(o!==void 0||n!==void 0)&&r()},[n,_,a,i,o]}class me extends yt{constructor(t){super(),bt(this,t,ve,ge,wt,{flapString:4,flapStringPending:0,flapStatusValues:1})}}const Se=async()=>{const e=await fetch("/flaps");if(!e.ok)throw console.error(e),new Error("Failed to get flap values");return(await e.text()).split("")};let Ft=!1;const we=async()=>{const e=await fetch("/text");if(!e.ok)throw Ft||(console.error("Failed to get flap string"),console.error(e)),Ft=!0,new Error("Failed to get flap string");const t=await e.text();return Ft=!1,t},ye=async()=>{const e=await fetch("/status");if(!e.ok)throw console.error(e),new Error("Failed to get flap status");return await e.json()},xt=async e=>{const t=new FormData;t.append("message",e);const i=await fetch("/set",{method:"POST",body:t});if(!i.ok)throw console.error(i),new Error("Failed to set flap string");return await i.text()};function be(e){let t,s,i,o,n,_,a,r,l,c,m,E="Refresh",O,y,N="Refresh Status",A,V,Y="Reset",D,P,nt;function d(u){e[12](u)}function U(u){e[13](u)}function C(u){e[14](u)}let F={};return e[0]!==void 0&&(F.flapString=e[0]),e[1]!==void 0&&(F.flapStringPending=e[1]),e[2]!==void 0&&(F.flapStatusValues=e[2]),t=new me({props:F}),mt.push(()=>Ct(t,"flapString",d)),mt.push(()=>Ct(t,"flapStringPending",U)),mt.push(()=>Ct(t,"flapStatusValues",C)),{c(){Ht(t.$$.fragment),n=b(),_=g("form"),a=g("label"),r=I(`Display:
        `),l=g("input"),c=b(),m=g("button"),m.textContent=E,O=b(),y=g("button"),y.textContent=N,A=b(),V=g("button"),V.textContent=Y,this.h()},l(u){Rt(t.$$.fragment,u),n=T(u),_=v(u,"FORM",{class:!0});var h=w(_);a=v(h,"LABEL",{});var S=w(a);r=q(S,`Display:
        `),l=v(S,"INPUT",{}),S.forEach(p),h.forEach(p),c=T(u),m=v(u,"BUTTON",{class:!0,"data-svelte-h":!0}),W(m)!=="svelte-or0dku"&&(m.textContent=E),O=T(u),y=v(u,"BUTTON",{class:!0,"data-svelte-h":!0}),W(y)!=="svelte-1155mz9"&&(y.textContent=N),A=T(u),V=v(u,"BUTTON",{class:!0,"data-svelte-h":!0}),W(V)!=="svelte-1469vlo"&&(V.textContent=Y),this.h()},h(){k(_,"class","inputForm svelte-14htwjr"),k(m,"class","button-89 svelte-14htwjr"),k(y,"class","button-89 svelte-14htwjr"),k(V,"class","button-89 svelte-14htwjr")},m(u,h){Pt(t,u,h),H(u,n,h),H(u,_,h),f(_,a),f(a,r),f(a,l),qt(l,e[1]),e[16](l),H(u,c,h),H(u,m,h),H(u,O,h),H(u,y,h),H(u,A,h),H(u,V,h),D=!0,P||(nt=[tt(window,"click",e[11]),tt(l,"input",e[15]),tt(l,"keydown",e[17]),tt(_,"submit",ae(e[9])),tt(m,"click",e[8]),tt(y,"click",e[7]),tt(V,"click",e[10])],P=!0)},p(u,[h]){const S={};!s&&h&1&&(s=!0,S.flapString=u[0],Dt(()=>s=!1)),!i&&h&2&&(i=!0,S.flapStringPending=u[1],Dt(()=>i=!1)),!o&&h&4&&(o=!0,S.flapStatusValues=u[2],Dt(()=>o=!1)),t.$set(S),h&2&&l.value!==u[1]&&qt(l,u[1])},i(u){D||(K(t.$$.fragment,u),D=!0)},o(u){et(t.$$.fragment,u),D=!1},d(u){u&&(p(n),p(_),p(c),p(m),p(O),p(y),p(A),p(V)),Lt(t,u),e[16](null),P=!1,le(nt)}}}function Te(e,t,s){var i=this&&this.__awaiter||function(d,U,C,F){function u(h){return h instanceof C?h:new C(function(S){S(h)})}return new(C||(C=Promise))(function(h,S){function ut(L){try{B(F.next(L))}catch(G){S(G)}}function st(L){try{B(F.throw(L))}catch(G){S(G)}}function B(L){L.done?h(L.value):u(L.value).then(ut,st)}B((F=F.apply(d,U||[])).next())})};let o="loading...",n="",_=ie(),a=ne;const r=()=>{const d=n.length/R,U=lt/R;if(d<U-1){const C=" ".repeat(R-n.length%R);s(1,n+=C)}},l=d=>{s(1,n=d.repeat(lt))},c=()=>i(void 0,void 0,void 0,function*(){ye().then(d=>{s(2,_=d)})}),m=()=>i(void 0,void 0,void 0,function*(){we().then(d=>{s(0,o=d)})}),E=()=>i(void 0,void 0,void 0,function*(){xt(n).then(()=>{s(0,o=n),s(1,n="")})}),O=()=>i(void 0,void 0,void 0,function*(){xt("reset").then(()=>{s(0,o="")})});let y;se(()=>{y.focus(),Se().then(d=>{s(3,a=d)}),m(),c()});const N=()=>{y.focus()};function A(d){o=d,s(0,o)}function V(d){n=d,s(1,n)}function Y(d){_=d,s(2,_)}function D(){n=this.value,s(1,n)}function P(d){mt[d?"unshift":"push"](()=>{y=d,s(4,y)})}return[o,n,_,a,y,r,l,c,m,E,O,N,A,V,Y,D,P,d=>{d.key==="Enter"&&d.shiftKey===!0||d.key==="Tab"?(r(),d.preventDefault()):d.ctrlKey&&d.key.length===1?l(d.key):d.key.length===1&&!a.includes(d.key.toLowerCase())&&d.preventDefault()}]}class ke extends yt{constructor(t){super(),bt(this,t,Te,be,wt,{})}}export{ke as component};
