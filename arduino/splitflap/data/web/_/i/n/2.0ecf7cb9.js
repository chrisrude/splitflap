import{s as be,n as Oe,b as ye,f as we,r as tt,o as lt}from"../c/s.bc760b9c.js";import{S as Ee,i as Ve,g as p,s as E,m as B,h as g,j as y,y as Y,c as V,n as q,f as h,k as T,a as R,x as f,o as G,r as Fe,u as He,z as se,v as Pe,d as W,t as te,w as Re,l as Be,p as Ze,b as xe,A as $e,B as Ce,C as qe,D as ne,E as nt}from"../c/i.aa439040.js";function Se(o){return(o==null?void 0:o.length)!==void 0?o:Array.from(o)}const et=[" ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9",".",",","'"],ae=24,D=12,We=et[0],st=()=>({state:"unknown",flap_index:0,moving:!1,home_state:!1,count_unexpected_home:0,count_missed_home:0}),Ke=o=>o.state==="normal"||o.state==="unknown",Ye=o=>o.count_missed_home>0||o.count_unexpected_home>0;function at(o){let e,i,r,s,l="State",d,t,u=o[0].state+"",n,c,v,S,z="Flap Index",b,k,C=o[0].flap_index+"",I,K,A,L,le="Moving",j,a,_=o[0].moving?"Yes":"No",m,U,N,w,J="Home State",oe,Q,O=o[0].home_state?"Home":"Not Home",F,X,Z,x,Ae="Unexpected<br/>Home",Te,ie,re=o[0].count_unexpected_home+"",ce,ke,$,ee,Le="Missed<br/>Home",De,ue,fe=o[0].count_missed_home+"",de;return{c(){e=p("div"),i=p("table"),r=p("tr"),s=p("th"),s.textContent=l,d=E(),t=p("td"),n=B(u),c=E(),v=p("tr"),S=p("th"),S.textContent=z,b=E(),k=p("td"),I=B(C),K=E(),A=p("tr"),L=p("th"),L.textContent=le,j=E(),a=p("td"),m=B(_),U=E(),N=p("tr"),w=p("th"),w.textContent=J,oe=E(),Q=p("td"),F=B(O),X=E(),Z=p("tr"),x=p("th"),x.innerHTML=Ae,Te=E(),ie=p("td"),ce=B(re),ke=E(),$=p("tr"),ee=p("th"),ee.innerHTML=Le,De=E(),ue=p("td"),de=B(fe),this.h()},l(H){e=g(H,"DIV",{class:!0});var M=y(e);i=g(M,"TABLE",{});var P=y(i);r=g(P,"TR",{});var he=y(r);s=g(he,"TH",{class:!0,"data-svelte-h":!0}),Y(s)!=="svelte-8azjil"&&(s.textContent=l),d=V(he),t=g(he,"TD",{});var Me=y(t);n=q(Me,u),Me.forEach(h),he.forEach(h),c=V(P),v=g(P,"TR",{});var _e=y(v);S=g(_e,"TH",{class:!0,"data-svelte-h":!0}),Y(S)!=="svelte-6pmfnd"&&(S.textContent=z),b=V(_e),k=g(_e,"TD",{});var ze=y(k);I=q(ze,C),ze.forEach(h),_e.forEach(h),K=V(P),A=g(P,"TR",{});var pe=y(A);L=g(pe,"TH",{class:!0,"data-svelte-h":!0}),Y(L)!=="svelte-lwsec8"&&(L.textContent=le),j=V(pe),a=g(pe,"TD",{});var Ie=y(a);m=q(Ie,_),Ie.forEach(h),pe.forEach(h),U=V(P),N=g(P,"TR",{});var ge=y(N);w=g(ge,"TH",{class:!0,"data-svelte-h":!0}),Y(w)!=="svelte-16b17l4"&&(w.textContent=J),oe=V(ge),Q=g(ge,"TD",{});var Ue=y(Q);F=q(Ue,O),Ue.forEach(h),ge.forEach(h),X=V(P),Z=g(P,"TR",{});var ve=y(Z);x=g(ve,"TH",{class:!0,"data-svelte-h":!0}),Y(x)!=="svelte-18hz36f"&&(x.innerHTML=Ae),Te=V(ve),ie=g(ve,"TD",{});var je=y(ie);ce=q(je,re),je.forEach(h),ve.forEach(h),ke=V(P),$=g(P,"TR",{});var me=y($);ee=g(me,"TH",{class:!0,"data-svelte-h":!0}),Y(ee)!=="svelte-1f9907h"&&(ee.innerHTML=Le),De=V(me),ue=g(me,"TD",{});var Ne=y(ue);de=q(Ne,fe),Ne.forEach(h),me.forEach(h),P.forEach(h),M.forEach(h),this.h()},h(){T(s,"class","svelte-29zy2o"),T(S,"class","svelte-29zy2o"),T(L,"class","svelte-29zy2o"),T(w,"class","svelte-29zy2o"),T(x,"class","svelte-29zy2o"),T(ee,"class","svelte-29zy2o"),T(e,"class","flap_status svelte-29zy2o")},m(H,M){R(H,e,M),f(e,i),f(i,r),f(r,s),f(r,d),f(r,t),f(t,n),f(i,c),f(i,v),f(v,S),f(v,b),f(v,k),f(k,I),f(i,K),f(i,A),f(A,L),f(A,j),f(A,a),f(a,m),f(i,U),f(i,N),f(N,w),f(N,oe),f(N,Q),f(Q,F),f(i,X),f(i,Z),f(Z,x),f(Z,Te),f(Z,ie),f(ie,ce),f(i,ke),f(i,$),f($,ee),f($,De),f($,ue),f(ue,de)},p(H,[M]){M&1&&u!==(u=H[0].state+"")&&G(n,u),M&1&&C!==(C=H[0].flap_index+"")&&G(I,C),M&1&&_!==(_=H[0].moving?"Yes":"No")&&G(m,_),M&1&&O!==(O=H[0].home_state?"Home":"Not Home")&&G(F,O),M&1&&re!==(re=H[0].count_unexpected_home+"")&&G(ce,re),M&1&&fe!==(fe=H[0].count_missed_home+"")&&G(de,fe)},i:Oe,o:Oe,d(H){H&&h(e)}}}function ot(o,e,i){let{status:r}=e;return o.$$set=s=>{"status"in s&&i(0,r=s.status)},[r]}class it extends Ee{constructor(e){super(),Ve(this,e,ot,at,be,{status:0})}}function rt(o){let e,i;return{c(){e=p("div"),i=B(o[0]),this.h()},l(r){e=g(r,"DIV",{class:!0});var s=y(e);i=q(s,o[0]),s.forEach(h),this.h()},h(){T(e,"class","flapActualValue svelte-1qldb3s"),se(e,"selected",o[2])},m(r,s){R(r,e,s),f(e,i)},p(r,s){s&1&&G(i,r[0]),s&4&&se(e,"selected",r[2])},d(r){r&&h(e)}}}function ut(o){let e,i;return{c(){e=p("div"),i=B(o[1]),this.h()},l(r){e=g(r,"DIV",{class:!0});var s=y(e);i=q(s,o[1]),s.forEach(h),this.h()},h(){T(e,"class","flapPendingValue svelte-1qldb3s")},m(r,s){R(r,e,s),f(e,i)},p(r,s){s&2&&G(i,r[1])},d(r){r&&h(e)}}}function ft(o){let e,i,r,s,l;function d(n,c){return n[1]!==void 0?ut:rt}let t=d(o),u=t(o);return s=new it({props:{status:o[3]}}),{c(){e=p("div"),u.c(),i=E(),r=p("div"),Fe(s.$$.fragment),this.h()},l(n){e=g(n,"DIV",{class:!0});var c=y(e);u.l(c),i=V(c),r=g(c,"DIV",{class:!0});var v=y(r);He(s.$$.fragment,v),v.forEach(h),c.forEach(h),this.h()},h(){T(r,"class","flap_status svelte-1qldb3s"),se(r,"error",!Ke(o[3])),se(r,"warning",Ye(o[3])),T(e,"class","flap svelte-1qldb3s")},m(n,c){R(n,e,c),u.m(e,null),f(e,i),f(e,r),Pe(s,r,null),l=!0},p(n,[c]){t===(t=d(n))&&u?u.p(n,c):(u.d(1),u=t(n),u&&(u.c(),u.m(e,i)));const v={};c&8&&(v.status=n[3]),s.$set(v),(!l||c&8)&&se(r,"error",!Ke(n[3])),(!l||c&8)&&se(r,"warning",Ye(n[3]))},i(n){l||(W(s.$$.fragment,n),l=!0)},o(n){te(s.$$.fragment,n),l=!1},d(n){n&&h(e),u.d(),Re(s)}}}function ct(o,e,i){let{value:r}=e,{pendingValue:s}=e,{selected:l=!1}=e,{status:d}=e;return o.$$set=t=>{"value"in t&&i(0,r=t.value),"pendingValue"in t&&i(1,s=t.pendingValue),"selected"in t&&i(2,l=t.selected),"status"in t&&i(3,d=t.status)},[r,s,l,d]}class dt extends Ee{constructor(e){super(),Ve(this,e,ct,ft,be,{value:0,pendingValue:1,selected:2,status:3})}}function Ge(o,e,i){const r=o.slice();return r[6]=e[i],r[8]=i,r}function Je(o,e,i){const r=o.slice();return r[9]=e[i],r[11]=i,r}function Qe(o){var r;let e,i;return e=new dt({props:{value:o[9].current,pendingValue:o[9].pending,status:o[1][o[8]*D+o[11]],selected:o[8]*D+o[11]===((r=o[0])==null?void 0:r.length)}}),{c(){Fe(e.$$.fragment)},l(s){He(e.$$.fragment,s)},m(s,l){Pe(e,s,l),i=!0},p(s,l){var t;const d={};l&4&&(d.value=s[9].current),l&4&&(d.pendingValue=s[9].pending),l&2&&(d.status=s[1][s[8]*D+s[11]]),l&1&&(d.selected=s[8]*D+s[11]===((t=s[0])==null?void 0:t.length)),e.$set(d)},i(s){i||(W(e.$$.fragment,s),i=!0)},o(s){te(e.$$.fragment,s),i=!1},d(s){Re(e,s)}}}function Xe(o){let e,i,r,s=Se(o[2].slice(o[8]*D,(o[8]+1)*D)),l=[];for(let t=0;t<s.length;t+=1)l[t]=Qe(Je(o,s,t));const d=t=>te(l[t],1,1,()=>{l[t]=null});return{c(){e=p("div");for(let t=0;t<l.length;t+=1)l[t].c();i=E(),this.h()},l(t){e=g(t,"DIV",{class:!0});var u=y(e);for(let n=0;n<l.length;n+=1)l[n].l(u);i=V(u),u.forEach(h),this.h()},h(){T(e,"class","flapRow svelte-ydaj79")},m(t,u){R(t,e,u);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(e,null);f(e,i),r=!0},p(t,u){if(u&7){s=Se(t[2].slice(t[8]*D,(t[8]+1)*D));let n;for(n=0;n<s.length;n+=1){const c=Je(t,s,n);l[n]?(l[n].p(c,u),W(l[n],1)):(l[n]=Qe(c),l[n].c(),W(l[n],1),l[n].m(e,i))}for(Ze(),n=s.length;n<l.length;n+=1)d(n);xe()}},i(t){if(!r){for(let u=0;u<s.length;u+=1)W(l[u]);r=!0}},o(t){l=l.filter(Boolean);for(let u=0;u<l.length;u+=1)te(l[u]);r=!1},d(t){t&&h(e),$e(l,t)}}}function ht(o){let e,i,r,s=Se({length:o[3]}),l=[];for(let t=0;t<s.length;t+=1)l[t]=Xe(Ge(o,s,t));const d=t=>te(l[t],1,1,()=>{l[t]=null});return{c(){e=p("div"),i=p("div");for(let t=0;t<l.length;t+=1)l[t].c();this.h()},l(t){e=g(t,"DIV",{class:!0});var u=y(e);i=g(u,"DIV",{style:!0});var n=y(i);for(let c=0;c<l.length;c+=1)l[c].l(n);n.forEach(h),u.forEach(h),this.h()},h(){Be(i,"display","contents"),Be(i,"--modules-per-row",D),T(e,"class","flapDisplay svelte-ydaj79")},m(t,u){R(t,e,u),f(e,i);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(i,null);r=!0},p(t,[u]){if(u&7){s=Se({length:t[3]});let n;for(n=0;n<s.length;n+=1){const c=Ge(t,s,n);l[n]?(l[n].p(c,u),W(l[n],1)):(l[n]=Xe(c),l[n].c(),W(l[n],1),l[n].m(i,null))}for(Ze(),n=s.length;n<l.length;n+=1)d(n);xe()}},i(t){if(!r){for(let u=0;u<s.length;u+=1)W(l[u]);r=!0}},o(t){l=l.filter(Boolean);for(let u=0;u<l.length;u+=1)te(l[u]);r=!1},d(t){t&&h(e),$e(l,t)}}}function _t(o,e,i){const r=ae/D;let{flapString:s}=e,{flapStringPending:l}=e,{flapStatusValues:d}=e,t=Array(ae).fill({current:We});const u=()=>{i(2,t=t.map((n,c)=>{var v,S;return{current:(v=s[c])!==null&&v!==void 0?v:We,pending:(S=l==null?void 0:l[c])!==null&&S!==void 0?S:void 0}}))};return o.$$set=n=>{"flapString"in n&&i(4,s=n.flapString),"flapStringPending"in n&&i(0,l=n.flapStringPending),"flapStatusValues"in n&&i(1,d=n.flapStatusValues)},o.$$.update=()=>{o.$$.dirty&17&&(s!==void 0||l!==void 0)&&u()},[l,d,t,r,s]}class pt extends Ee{constructor(e){super(),Ve(this,e,_t,ht,be,{flapString:4,flapStringPending:0,flapStatusValues:1})}}function gt(o){let e,i,r,s,l,d,t,u,n,c,v,S="Refresh",z,b,k="Refresh Status",C,I,K;function A(a){o[11](a)}function L(a){o[12](a)}function le(a){o[13](a)}let j={};return o[0]!==void 0&&(j.flapString=o[0]),o[1]!==void 0&&(j.flapStringPending=o[1]),o[2]!==void 0&&(j.flapStatusValues=o[2]),e=new pt({props:j}),ye.push(()=>Ce(e,"flapString",A)),ye.push(()=>Ce(e,"flapStringPending",L)),ye.push(()=>Ce(e,"flapStatusValues",le)),{c(){Fe(e.$$.fragment),l=E(),d=p("form"),t=p("label"),u=B(`Display:
        `),n=p("input"),c=E(),v=p("button"),v.textContent=S,z=E(),b=p("button"),b.textContent=k,this.h()},l(a){He(e.$$.fragment,a),l=V(a),d=g(a,"FORM",{class:!0});var _=y(d);t=g(_,"LABEL",{});var m=y(t);u=q(m,`Display:
        `),n=g(m,"INPUT",{}),m.forEach(h),_.forEach(h),c=V(a),v=g(a,"BUTTON",{class:!0,"data-svelte-h":!0}),Y(v)!=="svelte-or0dku"&&(v.textContent=S),z=V(a),b=g(a,"BUTTON",{class:!0,"data-svelte-h":!0}),Y(b)!=="svelte-err3u4"&&(b.textContent=k),this.h()},h(){T(d,"class","inputForm svelte-14htwjr"),T(v,"class","button-89 svelte-14htwjr"),T(b,"class","button-89 svelte-14htwjr")},m(a,_){Pe(e,a,_),R(a,l,_),R(a,d,_),f(d,t),f(t,u),f(t,n),qe(n,o[1]),o[15](n),R(a,c,_),R(a,v,_),R(a,z,_),R(a,b,_),C=!0,I||(K=[ne(window,"click",o[10]),ne(n,"input",o[14]),ne(n,"keydown",o[16]),ne(d,"submit",nt(o[7])),ne(v,"click",o[5]),ne(b,"click",o[6])],I=!0)},p(a,[_]){const m={};!i&&_&1&&(i=!0,m.flapString=a[0],we(()=>i=!1)),!r&&_&2&&(r=!0,m.flapStringPending=a[1],we(()=>r=!1)),!s&&_&4&&(s=!0,m.flapStatusValues=a[2],we(()=>s=!1)),e.$set(m),_&2&&n.value!==a[1]&&qe(n,a[1])},i(a){C||(W(e.$$.fragment,a),C=!0)},o(a){te(e.$$.fragment,a),C=!1},d(a){a&&(h(l),h(d),h(c),h(v),h(z),h(b)),Re(e,a),o[15](null),I=!1,tt(K)}}}function vt(o,e,i){var r=this&&this.__awaiter||function(a,_,m,U){function N(w){return w instanceof m?w:new m(function(J){J(w)})}return new(m||(m=Promise))(function(w,J){function oe(F){try{O(U.next(F))}catch(X){J(X)}}function Q(F){try{O(U.throw(F))}catch(X){J(X)}}function O(F){F.done?w(F.value):N(F.value).then(oe,Q)}O((U=U.apply(a,_||[])).next())})};let s="Hello World!",l="",d=!1,t=Array(ae);for(let a=0;a<ae;a++)t[a]=st();let u=et;const n=()=>r(void 0,void 0,void 0,function*(){const a=yield fetch("/flaps");if(a.ok){const _=yield a.text();i(3,u=_.split("")),console.log(_)}else console.error("Failed to get flap values"),console.error(a)}),c=()=>r(void 0,void 0,void 0,function*(){const a=yield fetch("/text");a.ok?(i(0,s=yield a.text()),d=!1):(d||(console.error("Failed to get flap string"),console.error(a)),d=!0)}),v=()=>r(void 0,void 0,void 0,function*(){const a=yield fetch("/status");if(a.ok){const _=yield a.json();console.log(_),i(2,t=_)}else console.error("Failed to get flap status"),console.error(a)}),S=()=>r(void 0,void 0,void 0,function*(){const a=new FormData;a.append("message",l);const _=fetch("/set",{method:"POST",body:a}),m=yield _;if(m.ok){const U=yield m.text();i(0,s=U),i(1,l="")}else console.error(m);return _}),z=()=>{const a=l.length/D,_=ae/D;if(a<_-1){const m=" ".repeat(D-l.length%D);i(1,l+=m)}},b=a=>{i(1,l=a.repeat(ae))};t[t.length-1].count_missed_home=3,t[t.length-2].count_unexpected_home=2,t[t.length-3].state="sensor_error";let k;lt(()=>{k.focus(),c(),v(),n()});const C=()=>{k.focus()};function I(a){s=a,i(0,s)}function K(a){l=a,i(1,l)}function A(a){t=a,i(2,t)}function L(){l=this.value,i(1,l)}function le(a){ye[a?"unshift":"push"](()=>{k=a,i(4,k)})}return[s,l,t,u,k,c,v,S,z,b,C,I,K,A,L,le,a=>{a.key==="Enter"&&a.shiftKey===!0||a.key==="Tab"?(z(),a.preventDefault()):a.ctrlKey&&a.key.length===1?b(a.key):a.key.length===1&&!u.includes(a.key.toLowerCase())&&a.preventDefault()}]}class St extends Ee{constructor(e){super(),Ve(this,e,vt,gt,be,{})}}export{St as component};
