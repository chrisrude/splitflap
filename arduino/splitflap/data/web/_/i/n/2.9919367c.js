import{s as bt,n as Bt,b as mt,f as Tt,r as te,o as ee}from"../c/s.bc760b9c.js";import{S as Dt,i as kt,g as h,s as y,m as B,h as g,j as S,y as K,c as b,n as q,f as _,k as G,a as R,x as u,o as Y,r as Ft,u as Pt,z as St,v as Rt,d as z,t as $,w as At,l as qt,p as Xt,b as Zt,A as xt,B as wt,C as zt,D as nt,E as le}from"../c/i.aa439040.js";function yt(i){return(i==null?void 0:i.length)!==void 0?i:Array.from(i)}const $t=[" ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9",".",",","'"],rt=16,V=8,Wt=$t[0],ne=()=>({state:"unknown",flap_index:0,moving:!1,home_state:!1,count_unexpected_home:0,count_missed_home:0}),Kt=i=>i.state==="normal"||i.state==="unknown";function se(i){let t,a,f,s,e="State",c,n,r=i[0].state+"",l,d,v,D,I="Flap Index",k,E,C=i[0].flap_index+"",L,W,A,U,tt="Moving",N,o,p=i[0].moving?"Yes":"No",m,H,O,T,J="Home State",st,Q,M=i[0].home_state?"Home":"Not Home",w,X,Z,et,jt="Unexpected Home",Et,at,ot=i[0].count_unexpected_home+"",ut,Vt,x,lt,It="Missed Home",Ct,it,ft=i[0].count_missed_home+"",dt;return{c(){t=h("div"),a=h("table"),f=h("tr"),s=h("td"),s.textContent=e,c=y(),n=h("td"),l=B(r),d=y(),v=h("tr"),D=h("td"),D.textContent=I,k=y(),E=h("td"),L=B(C),W=y(),A=h("tr"),U=h("td"),U.textContent=tt,N=y(),o=h("td"),m=B(p),H=y(),O=h("tr"),T=h("td"),T.textContent=J,st=y(),Q=h("td"),w=B(M),X=y(),Z=h("tr"),et=h("td"),et.textContent=jt,Et=y(),at=h("td"),ut=B(ot),Vt=y(),x=h("tr"),lt=h("td"),lt.textContent=It,Ct=y(),it=h("td"),dt=B(ft),this.h()},l(F){t=g(F,"DIV",{class:!0});var j=S(t);a=g(j,"TABLE",{});var P=S(a);f=g(P,"TR",{});var ct=S(f);s=g(ct,"TD",{"data-svelte-h":!0}),K(s)!=="svelte-qr71y5"&&(s.textContent=e),c=b(ct),n=g(ct,"TD",{});var Lt=S(n);l=q(Lt,r),Lt.forEach(_),ct.forEach(_),d=b(P),v=g(P,"TR",{});var _t=S(v);D=g(_t,"TD",{"data-svelte-h":!0}),K(D)!=="svelte-15v9c8p"&&(D.textContent=I),k=b(_t),E=g(_t,"TD",{});var Ut=S(E);L=q(Ut,C),Ut.forEach(_),_t.forEach(_),W=b(P),A=g(P,"TR",{});var pt=S(A);U=g(pt,"TD",{"data-svelte-h":!0}),K(U)!=="svelte-g440js"&&(U.textContent=tt),N=b(pt),o=g(pt,"TD",{});var Ht=S(o);m=q(Ht,p),Ht.forEach(_),pt.forEach(_),H=b(P),O=g(P,"TR",{});var ht=S(O);T=g(ht,"TD",{"data-svelte-h":!0}),K(T)!=="svelte-1wimkvk"&&(T.textContent=J),st=b(ht),Q=g(ht,"TD",{});var Nt=S(Q);w=q(Nt,M),Nt.forEach(_),ht.forEach(_),X=b(P),Z=g(P,"TR",{});var gt=S(Z);et=g(gt,"TD",{"data-svelte-h":!0}),K(et)!=="svelte-uotm2o"&&(et.textContent=jt),Et=b(gt),at=g(gt,"TD",{});var Ot=S(at);ut=q(Ot,ot),Ot.forEach(_),gt.forEach(_),Vt=b(P),x=g(P,"TR",{});var vt=S(x);lt=g(vt,"TD",{"data-svelte-h":!0}),K(lt)!=="svelte-78zzkq"&&(lt.textContent=It),Ct=b(vt),it=g(vt,"TD",{});var Mt=S(it);dt=q(Mt,ft),Mt.forEach(_),vt.forEach(_),P.forEach(_),j.forEach(_),this.h()},h(){G(t,"class","flap_status")},m(F,j){R(F,t,j),u(t,a),u(a,f),u(f,s),u(f,c),u(f,n),u(n,l),u(a,d),u(a,v),u(v,D),u(v,k),u(v,E),u(E,L),u(a,W),u(a,A),u(A,U),u(A,N),u(A,o),u(o,m),u(a,H),u(a,O),u(O,T),u(O,st),u(O,Q),u(Q,w),u(a,X),u(a,Z),u(Z,et),u(Z,Et),u(Z,at),u(at,ut),u(a,Vt),u(a,x),u(x,lt),u(x,Ct),u(x,it),u(it,dt)},p(F,[j]){j&1&&r!==(r=F[0].state+"")&&Y(l,r),j&1&&C!==(C=F[0].flap_index+"")&&Y(L,C),j&1&&p!==(p=F[0].moving?"Yes":"No")&&Y(m,p),j&1&&M!==(M=F[0].home_state?"Home":"Not Home")&&Y(w,M),j&1&&ot!==(ot=F[0].count_unexpected_home+"")&&Y(ut,ot),j&1&&ft!==(ft=F[0].count_missed_home+"")&&Y(dt,ft)},i:Bt,o:Bt,d(F){F&&_(t)}}}function ae(i,t,a){let{status:f}=t;return i.$$set=s=>{"status"in s&&a(0,f=s.status)},[f]}class oe extends Dt{constructor(t){super(),kt(this,t,ae,se,bt,{status:0})}}function ie(i){let t,a;return{c(){t=h("div"),a=B(i[0]),this.h()},l(f){t=g(f,"DIV",{class:!0});var s=S(t);a=q(s,i[0]),s.forEach(_),this.h()},h(){G(t,"class","flapActualValue svelte-1agnjor"),St(t,"selected",i[2])},m(f,s){R(f,t,s),u(t,a)},p(f,s){s&1&&Y(a,f[0]),s&4&&St(t,"selected",f[2])},d(f){f&&_(t)}}}function fe(i){let t,a;return{c(){t=h("div"),a=B(i[1]),this.h()},l(f){t=g(f,"DIV",{class:!0});var s=S(t);a=q(s,i[1]),s.forEach(_),this.h()},h(){G(t,"class","flapPendingValue svelte-1agnjor")},m(f,s){R(f,t,s),u(t,a)},p(f,s){s&2&&Y(a,f[1])},d(f){f&&_(t)}}}function re(i){let t,a,f,s,e;function c(l,d){return l[1]!==void 0?fe:ie}let n=c(i),r=n(i);return s=new oe({props:{status:i[3]}}),{c(){t=h("div"),r.c(),a=y(),f=h("div"),Ft(s.$$.fragment),this.h()},l(l){t=g(l,"DIV",{class:!0});var d=S(t);r.l(d),a=b(d),f=g(d,"DIV",{class:!0});var v=S(f);Pt(s.$$.fragment,v),v.forEach(_),d.forEach(_),this.h()},h(){G(f,"class","flap_status svelte-1agnjor"),St(f,"error",!Kt(i[3])),G(t,"class","flap svelte-1agnjor")},m(l,d){R(l,t,d),r.m(t,null),u(t,a),u(t,f),Rt(s,f,null),e=!0},p(l,[d]){n===(n=c(l))&&r?r.p(l,d):(r.d(1),r=n(l),r&&(r.c(),r.m(t,a)));const v={};d&8&&(v.status=l[3]),s.$set(v),(!e||d&8)&&St(f,"error",!Kt(l[3]))},i(l){e||(z(s.$$.fragment,l),e=!0)},o(l){$(s.$$.fragment,l),e=!1},d(l){l&&_(t),r.d(),At(s)}}}function ue(i,t,a){let{value:f}=t,{pendingValue:s}=t,{selected:e=!1}=t,{status:c}=t;return i.$$set=n=>{"value"in n&&a(0,f=n.value),"pendingValue"in n&&a(1,s=n.pendingValue),"selected"in n&&a(2,e=n.selected),"status"in n&&a(3,c=n.status)},[f,s,e,c]}class de extends Dt{constructor(t){super(),kt(this,t,ue,re,bt,{value:0,pendingValue:1,selected:2,status:3})}}function Yt(i,t,a){const f=i.slice();return f[6]=t[a],f[8]=a,f}function Gt(i,t,a){const f=i.slice();return f[9]=t[a],f[11]=a,f}function Jt(i){var f;let t,a;return t=new de({props:{value:i[9].current,pendingValue:i[9].pending,status:i[1][i[8]*V+i[11]],selected:i[8]*V+i[11]===((f=i[0])==null?void 0:f.length)}}),{c(){Ft(t.$$.fragment)},l(s){Pt(t.$$.fragment,s)},m(s,e){Rt(t,s,e),a=!0},p(s,e){var n;const c={};e&4&&(c.value=s[9].current),e&4&&(c.pendingValue=s[9].pending),e&2&&(c.status=s[1][s[8]*V+s[11]]),e&1&&(c.selected=s[8]*V+s[11]===((n=s[0])==null?void 0:n.length)),t.$set(c)},i(s){a||(z(t.$$.fragment,s),a=!0)},o(s){$(t.$$.fragment,s),a=!1},d(s){At(t,s)}}}function Qt(i){let t,a,f,s=yt(i[2].slice(i[8]*V,(i[8]+1)*V)),e=[];for(let n=0;n<s.length;n+=1)e[n]=Jt(Gt(i,s,n));const c=n=>$(e[n],1,1,()=>{e[n]=null});return{c(){t=h("div");for(let n=0;n<e.length;n+=1)e[n].c();a=y(),this.h()},l(n){t=g(n,"DIV",{class:!0});var r=S(t);for(let l=0;l<e.length;l+=1)e[l].l(r);a=b(r),r.forEach(_),this.h()},h(){G(t,"class","flapRow svelte-ydaj79")},m(n,r){R(n,t,r);for(let l=0;l<e.length;l+=1)e[l]&&e[l].m(t,null);u(t,a),f=!0},p(n,r){if(r&7){s=yt(n[2].slice(n[8]*V,(n[8]+1)*V));let l;for(l=0;l<s.length;l+=1){const d=Gt(n,s,l);e[l]?(e[l].p(d,r),z(e[l],1)):(e[l]=Jt(d),e[l].c(),z(e[l],1),e[l].m(t,a))}for(Xt(),l=s.length;l<e.length;l+=1)c(l);Zt()}},i(n){if(!f){for(let r=0;r<s.length;r+=1)z(e[r]);f=!0}},o(n){e=e.filter(Boolean);for(let r=0;r<e.length;r+=1)$(e[r]);f=!1},d(n){n&&_(t),xt(e,n)}}}function ce(i){let t,a,f,s=yt({length:i[3]}),e=[];for(let n=0;n<s.length;n+=1)e[n]=Qt(Yt(i,s,n));const c=n=>$(e[n],1,1,()=>{e[n]=null});return{c(){t=h("div"),a=h("div");for(let n=0;n<e.length;n+=1)e[n].c();this.h()},l(n){t=g(n,"DIV",{class:!0});var r=S(t);a=g(r,"DIV",{style:!0});var l=S(a);for(let d=0;d<e.length;d+=1)e[d].l(l);l.forEach(_),r.forEach(_),this.h()},h(){qt(a,"display","contents"),qt(a,"--modules-per-row",V),G(t,"class","flapDisplay svelte-ydaj79")},m(n,r){R(n,t,r),u(t,a);for(let l=0;l<e.length;l+=1)e[l]&&e[l].m(a,null);f=!0},p(n,[r]){if(r&7){s=yt({length:n[3]});let l;for(l=0;l<s.length;l+=1){const d=Yt(n,s,l);e[l]?(e[l].p(d,r),z(e[l],1)):(e[l]=Qt(d),e[l].c(),z(e[l],1),e[l].m(a,null))}for(Xt(),l=s.length;l<e.length;l+=1)c(l);Zt()}},i(n){if(!f){for(let r=0;r<s.length;r+=1)z(e[r]);f=!0}},o(n){e=e.filter(Boolean);for(let r=0;r<e.length;r+=1)$(e[r]);f=!1},d(n){n&&_(t),xt(e,n)}}}function _e(i,t,a){const f=rt/V;let{flapString:s}=t,{flapStringPending:e}=t,{flapStatusValues:c}=t,n=Array(rt).fill({current:Wt});const r=()=>{a(2,n=n.map((l,d)=>{var v,D;return{current:(v=s[d])!==null&&v!==void 0?v:Wt,pending:(D=e==null?void 0:e[d])!==null&&D!==void 0?D:void 0}}))};return i.$$set=l=>{"flapString"in l&&a(4,s=l.flapString),"flapStringPending"in l&&a(0,e=l.flapStringPending),"flapStatusValues"in l&&a(1,c=l.flapStatusValues)},i.$$.update=()=>{i.$$.dirty&17&&(s!==void 0||e!==void 0)&&r()},[e,c,n,f,s]}class pe extends Dt{constructor(t){super(),kt(this,t,_e,ce,bt,{flapString:4,flapStringPending:0,flapStatusValues:1})}}function he(i){let t,a,f,s,e,c,n,r,l,d,v,D="Refresh",I,k,E="Refresh Status",C,L,W;function A(o){i[11](o)}function U(o){i[12](o)}function tt(o){i[13](o)}let N={};return i[0]!==void 0&&(N.flapString=i[0]),i[1]!==void 0&&(N.flapStringPending=i[1]),i[2]!==void 0&&(N.flapStatusValues=i[2]),t=new pe({props:N}),mt.push(()=>wt(t,"flapString",A)),mt.push(()=>wt(t,"flapStringPending",U)),mt.push(()=>wt(t,"flapStatusValues",tt)),{c(){Ft(t.$$.fragment),e=y(),c=h("form"),n=h("label"),r=B(`Display:
        `),l=h("input"),d=y(),v=h("button"),v.textContent=D,I=y(),k=h("button"),k.textContent=E,this.h()},l(o){Pt(t.$$.fragment,o),e=b(o),c=g(o,"FORM",{class:!0});var p=S(c);n=g(p,"LABEL",{});var m=S(n);r=q(m,`Display:
        `),l=g(m,"INPUT",{}),m.forEach(_),p.forEach(_),d=b(o),v=g(o,"BUTTON",{"data-svelte-h":!0}),K(v)!=="svelte-1f3jxf"&&(v.textContent=D),I=b(o),k=g(o,"BUTTON",{"data-svelte-h":!0}),K(k)!=="svelte-lhgru1"&&(k.textContent=E),this.h()},h(){G(c,"class","inputForm svelte-1ka4xs7")},m(o,p){Rt(t,o,p),R(o,e,p),R(o,c,p),u(c,n),u(n,r),u(n,l),zt(l,i[1]),i[15](l),R(o,d,p),R(o,v,p),R(o,I,p),R(o,k,p),C=!0,L||(W=[nt(window,"click",i[10]),nt(l,"input",i[14]),nt(l,"keydown",i[16]),nt(c,"submit",le(i[7])),nt(v,"click",i[5]),nt(k,"click",i[6])],L=!0)},p(o,[p]){const m={};!a&&p&1&&(a=!0,m.flapString=o[0],Tt(()=>a=!1)),!f&&p&2&&(f=!0,m.flapStringPending=o[1],Tt(()=>f=!1)),!s&&p&4&&(s=!0,m.flapStatusValues=o[2],Tt(()=>s=!1)),t.$set(m),p&2&&l.value!==o[1]&&zt(l,o[1])},i(o){C||(z(t.$$.fragment,o),C=!0)},o(o){$(t.$$.fragment,o),C=!1},d(o){o&&(_(e),_(c),_(d),_(v),_(I),_(k)),At(t,o),i[15](null),L=!1,te(W)}}}function ge(i,t,a){var f=this&&this.__awaiter||function(o,p,m,H){function O(T){return T instanceof m?T:new m(function(J){J(T)})}return new(m||(m=Promise))(function(T,J){function st(w){try{M(H.next(w))}catch(X){J(X)}}function Q(w){try{M(H.throw(w))}catch(X){J(X)}}function M(w){w.done?T(w.value):O(w.value).then(st,Q)}M((H=H.apply(o,p||[])).next())})};let s="Hello World!",e="",c=!1,n=Array(rt).fill(ne()),r=$t;const l=()=>f(void 0,void 0,void 0,function*(){const o=yield fetch("/flaps");if(o.ok){const p=yield o.text();console.log(p)}else console.error("Failed to get flap values"),console.error(o)}),d=()=>f(void 0,void 0,void 0,function*(){const o=yield fetch("/text");o.ok?(a(0,s=yield o.text()),c=!1):(c||(console.error("Failed to get flap string"),console.error(o)),c=!0)}),v=()=>f(void 0,void 0,void 0,function*(){const o=yield fetch("/status");if(o.ok){const p=yield o.json();console.log(p),a(2,n=p)}else console.error("Failed to get flap status"),console.error(o)}),D=()=>f(void 0,void 0,void 0,function*(){const o=new FormData;o.append("message",e);const p=fetch("/set",{method:"POST",body:o}),m=yield p;if(m.ok){const H=yield m.text();a(0,s=H),a(1,e="")}else console.error(m);return p}),I=()=>{const o=e.length/V,p=rt/V;if(o<p-1){const m=" ".repeat(V-e.length%V);a(1,e+=m)}},k=o=>{a(1,e=o.repeat(rt))};let E;ee(()=>{E.focus(),d(),v(),l()});const C=()=>{E.focus()};function L(o){s=o,a(0,s)}function W(o){e=o,a(1,e)}function A(o){n=o,a(2,n)}function U(){e=this.value,a(1,e)}function tt(o){mt[o?"unshift":"push"](()=>{E=o,a(3,E)})}return[s,e,n,E,r,d,v,D,I,k,C,L,W,A,U,tt,o=>{o.key==="Enter"&&o.shiftKey===!0||o.key==="Tab"?(I(),o.preventDefault()):o.ctrlKey&&o.key.length===1?k(o.key):o.key.length===1&&!r.includes(o.key.toLowerCase())&&o.preventDefault()}]}class Se extends Dt{constructor(t){super(),kt(this,t,ge,he,bt,{})}}export{Se as component};
